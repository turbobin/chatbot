import{d as U,a9 as D,h as y,a1 as j,r as x,S as H,af as A,ah as E,I as o,M as c,a3 as u,R as l,$ as F,K as s,Z as _,a2 as L,N as J,b5 as Q,_ as B,bh as Z,J as q,Q as G,al as O,bi as W,a5 as m,a4 as z,U as n,bj as X,ai as Y,b8 as ee,l as v,bk as te}from"./index-4e48d220.js";const se={class:"space-y-4"},ae={class:"flex items-center space-x-4"},re=l("span",{class:"flex-shrink-0 w-[100px]"},"当前会话选择：",-1),le={class:"w-[200px]"},oe={style:{color:"darkred"}},ne={class:"flex items-center right-aligned"},ie={class:"flex flex-col items-center gap-2"},pe=U({__name:"Prompt",props:{visible:{type:Boolean},roomId:null},emits:["update:visible"],setup(V,{emit:I}){const b=V,K=D(),i=y(()=>K.getChatHistoryByCurrentActive),h=j(),p=x(!1),P="设定当前会话类型",f=y({get(){return b.visible},set(a){I("update:visible",a)}}),g=x(""),{isMobile:d}=H(),C=A(),k=x(C.promptList),$=()=>{const[a,t]=d.value?[15,20]:[20,30];return k.value.map(e=>({renderKey:e.key.length<=a?e.key:`${e.key.substring(0,a)}...`,renderValue:e.value.length<=t?e.value:`${e.value.substring(0,t)}...`,renderDescription:e.description.length<=t?e.description:`${e.description.substring(0,t)}...`,key:e.key,value:e.value,description:e.description}))},M=y(()=>{const[a,t]=d.value?[6,5]:[7,15];return{pageSize:a,pageSlot:t}}),R=(()=>[{title:n("store.title"),key:"renderKey"},{title:n("store.description"),key:"description"},{title:n("common.action"),key:"actions",width:100,align:"center",render(a){var t;return a.key===((t=i.value)==null?void 0:t.role)?v("div",{class:"flex items-center flex-col gap-2"},{default:()=>[v(m,{tertiary:!0,size:"small",type:"error"},{default:()=>n("common.selected")})]}):v("div",{class:"flex items-center flex-col gap-2"},{default:()=>[v(m,{tertiary:!0,size:"small",type:"info",onClick:()=>N(a.key,a.value)},{default:()=>n("common.select")})]})}}])();E(()=>k,()=>{C.updatePromptList(k.value)},{deep:!0});const w=y(()=>{const a=$(),t=g.value;return t&&t!==""?a.filter(e=>e.renderKey.includes(t)||e.renderValue.includes(t)||e.description.includes(t)):a});async function N(a,t){if(!(!a||!t)){p.value=!0;try{const{status:e,message:r}=await te(a??"",t??"",+b.roomId);i.value&&(i.value.role=a),e=="Success"?h.success("已选择："+a):h.success(r),f.value=!0}catch(e){h.error(e.message)}p.value=!1}}return(a,t)=>(o(),c(s(ee),{show:s(f),"onUpdate:show":t[1]||(t[1]=e=>Y(f)?f.value=e:null),"auto-focus":!1,class:"custom-card",preset:"card",style:{width:"90%","max-width":"900px"},title:P,size:"huge",bordered:!1},{default:u(()=>{var e;return[l("div",se,[l("div",{class:F(["flex gap-3 mb-4",[s(d)?"flex-col":"flex-row justify-between"]])},[l("div",ae,[re,l("div",le,[l("span",oe,_(((e=s(i))==null?void 0:e.role)??"默认"),1)])]),l("div",ne,[L(s(J),{value:g.value,"onUpdate:value":t[0]||(t[0]=r=>g.value=r),placeholder:"Search...",style:{width:"100%"}},null,8,["value"])])],2),s(d)?B("",!0):(o(),c(s(Q),{key:0,"max-height":400,columns:s(R),data:s(w),pagination:s(M),bordered:!1},null,8,["columns","data","pagination"])),s(d)?(o(),c(s(Z),{key:1,style:{"max-height":"400px","overflow-y":"auto"}},{default:u(()=>[(o(!0),q(G,null,O(s(w),(r,T)=>(o(),c(s(W),{key:T},{suffix:u(()=>{var S;return[l("div",ie,[s(i)&&r.key===((S=s(i))==null?void 0:S.role)?(o(),c(s(m),{key:0,tertiary:"",size:"small",loading:p.value,type:"error"},{default:u(()=>[z(_(s(n)("common.selected")),1)]),_:1},8,["loading"])):(o(),c(s(m),{key:1,tertiary:"",size:"small",loading:p.value,type:"success",onClick:ue=>N(r.key,r.value)},{default:u(()=>[z(_(s(n)("common.select")),1)]),_:2},1032,["loading","onClick"]))])]}),default:u(()=>[L(s(X),{title:r.renderKey,description:r.description},null,8,["title","description"])]),_:2},1024))),128))]),_:1})):B("",!0)])]}),_:1},8,["show"]))}});export{pe as default};
